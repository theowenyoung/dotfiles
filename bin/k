#!/bin/bash
set -e;
kak -clear
server_name="$(basename `PWD`)"
# socket_file may be empty if no kakoune daemon is running
socket_file=$(kak -l | grep $server_name || echo "")
if [[ -z "${socket_file}" ]]; then        
    # Create new kakoune daemon for current dir
    kak -d -s $server_name &
fi

kak -c $server_name $@